var F=Object.defineProperty,q=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var P=(e,o,t)=>o in e?F(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,A=(e,o)=>{for(var t in o||(o={}))Y.call(o,t)&&P(e,t,o[t]);if(N)for(var t of N(o))Q.call(o,t)&&P(e,t,o[t]);return e},C=(e,o)=>q(e,K(o));import{d as b,r as V,o as m,c as G,w,a as E,n as R,b as g,e as u,f as J,g as Z,h as X,u as y,i as l,t as ee,j as p,k as D,l as _,m as te,v as oe,p as re,q as ne,s as se,x as ae,E as W,y as ie,z as ce,S as le,A as de}from"./vendor.626a96d0.js";const ue=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}};ue();const fe=["href"],S=b({name:"Button",props:{to:null,href:null},setup(e){const o="border-1 hover:border-gray-300 dark:border-gray-400 dark:hover:border-gray-500 rounded p-2 flex items-center justify-center cursor-pointer";return(t,a)=>{const r=V("router-link");return e.to?(m(),G(r,{key:0,class:R(o),to:e.to},{default:w(()=>[E(t.$slots,"default")]),_:3},8,["to"])):e.href?(m(),g("a",{key:1,href:e.href,target:"_blank",rel:"noopener noreferrer",class:R(o)},[E(t.$slots,"default")],8,fe)):(m(),g("button",{key:2,type:"button",class:R(o)},[E(t.$slots,"default")]))}}}),me={class:"m-2 flex flex-col rounded-md p-4 bg-white border-1 border-gray-200 shadow-xl z-20 md:w-104 dark:bg-dark-400 dark:text-gray-300 dark:border-dark-800"},pe={class:"flex flex-col text-center gap-4"},_e=l("span",{class:"text-xl mb-2"},"Wuhuu es gibt ein Update!",-1),ve=l("span",null,"Die neue Version soll dir bei der Navigation durch Kiel noch besser helfen.",-1),he=_("Schick uns gerne Feedback an "),ge=["href"],ye=_(" und folge uns auf "),ke=l("a",{href:"https://www.instagram.com/kiel.live/",target:"_blank",class:"underline"},"Instagram",-1),be=_("."),we={class:"flex flex-row w-full justify-center mt-8"},xe=_("Nice!"),j=b({name:"UpdateNotice",setup(e){const o="kiel-live-version-v1",t="2.0.0",a=atob("YW5kcm9pZEBqdTYwLmRl"),r=u(localStorage.getItem(o)),s=J(()=>r.value!==null&&r.value!==t);Z(async()=>{const i=localStorage.getItem("version");i!==null&&(r.value=i,localStorage.removeItem("version"))}),X(s,()=>{if(!s.value)return;const i=3*1e3,d=Date.now()+i,c=setInterval(()=>{if(d-Date.now()<=0){clearInterval(c);return}te({particleCount:100,spread:70,origin:{y:1.1},startVelocity:90,zIndex:2e3})},250)},{immediate:!0});function n(){localStorage.setItem(o,t),r.value=t}return(i,d)=>y(s)?(m(),g("div",{key:0,class:"flex fixed top-0 left-0 right-0 bottom-0 bg-gray-900 bg-opacity-80 z-1000 justify-center items-center",onClick:n},[l("div",me,[l("div",pe,[_e,ve,l("span",null,[he,l("a",{href:`mailto:${y(a)}`,class:"underline"},ee(y(a)),9,ge),ye,ke,be])]),l("div",we,[p(S,{onClick:n},{default:w(()=>[xe]),_:1})])])])):D("",!0)}});function Ee(e={}){const{immediate:o=!1,onNeedRefresh:t,onOfflineReady:a,onRegistered:r,onRegisterError:s}=e;let n,i;const d=async(c=!0)=>{c&&(n==null||n.addEventListener("controlling",$=>{$.isUpdate&&window.location.reload()})),i&&i.waiting&&await re(i.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){n=new oe("/sw.js",{scope:"/"}),n.addEventListener("activated",c=>{c.isUpdate||a==null||a()});{const c=()=>{t==null||t()};n.addEventListener("waiting",c),n.addEventListener("externalwaiting",c)}n.register({immediate:o}).then(c=>{i=c,r==null||r(c)}).catch(c=>{s==null||s(c)})}return d}function Re(e={}){const{immediate:o=!0,onNeedRefresh:t,onOfflineReady:a,onRegistered:r,onRegisterError:s}=e,n=u(!1),i=u(!1);return{updateServiceWorker:Ee({immediate:o,onNeedRefresh(){n.value=!0,t==null||t()},onOfflineReady(){i.value=!0,a==null||a()},onRegistered:r,onRegisterError:s}),offlineReady:i,needRefresh:n}}const Se={key:0,class:"fixed left-0 right-0 bottom-0 mx-2 mb-2 flex flex-col rounded-md p-4 items-center justify-center bg-white border-1 border-gray-200 shadow-xl z-20 md:transform md:-translate-x-1/2 md:right-auto md:left-1/2 md:w-96 dark:bg-dark-400 dark:text-gray-300 dark:border-dark-800",role:"alert"},Ie=l("div",{class:"mb-2 text-xl"},[l("span",null,"Eine neue Version ist verf\xFCgbar.")],-1),Le={class:"flex flex-row w-full gap-x-4 justify-center"},Oe=_("Installieren"),$e=_("Abbrechen"),T=b({name:"ReloadPrompt",setup(e){const{needRefresh:o,updateServiceWorker:t}=Re(),a=async()=>{o.value=!1};return(r,s)=>y(o)?(m(),g("div",Se,[Ie,l("div",Le,[p(S,{onClick:s[0]||(s[0]=n=>y(t)(!0))},{default:w(()=>[Oe]),_:1}),p(S,{onClick:a},{default:w(()=>[$e]),_:1})])])):D("",!0)}});function z(e){e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}const f=u(),Ne=()=>f.value!==void 0?f:window.matchMedia?(f.value=window.matchMedia("(prefers-color-scheme: dark)").matches,z(f.value),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{f.value=e.matches,z(f.value)}),f):(f.value=!1,f);var Pe=(e,o)=>{const t=e.__vccOpts||e;for(const[a,r]of o)t[a]=r;return t};const Ae=b({name:"App",components:{ReloadPrompt:T,UpdateNotice:j},setup(){return Ne(),{}}}),Ce={class:"app flex flex-col m-auto w-full h-full bg-gray-100 dark:bg-dark-400 dark:text-gray-300"};function Ve(e,o,t,a,r,s){const n=V("router-view"),i=T,d=j;return m(),g("div",Ce,[p(n),p(i),p(d)])}var De=Pe(Ae,[["render",Ve],["__scopeId","data-v-2178efe9"]]);const We="modulepreload",M={},je="/",v=function(o,t){return!t||t.length===0?o():Promise.all(t.map(a=>{if(a=`${je}${a}`,a in M)return;M[a]=!0;const r=a.endsWith(".css"),s=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${s}`))return;const n=document.createElement("link");if(n.rel=r?"stylesheet":We,r||(n.as="script",n.crossOrigin=""),n.href=a,document.head.appendChild(n),r)return new Promise((i,d)=>{n.addEventListener("load",i),n.addEventListener("error",d)})})).then(()=>o())};let I=!0;const Te=[{path:"/",name:"home",component:()=>v(()=>import("./Home.50025206.js"),["assets/Home.50025206.js","assets/Home.1ee9be26.css","assets/vendor.626a96d0.js"])},{path:"/map/:markerType/:markerId",name:"map-marker",component:()=>v(()=>import("./Home.50025206.js"),["assets/Home.50025206.js","assets/Home.1ee9be26.css","assets/vendor.626a96d0.js"]),props:!0},{path:"/search",name:"search",component:()=>v(()=>import("./Home.50025206.js"),["assets/Home.50025206.js","assets/Home.1ee9be26.css","assets/vendor.626a96d0.js"]),props:!0},{path:"/favorites",name:"favorites",component:()=>v(()=>import("./Home.50025206.js"),["assets/Home.50025206.js","assets/Home.1ee9be26.css","assets/vendor.626a96d0.js"]),props:!0},{path:"/about",name:"about",component:()=>v(()=>import("./Home.50025206.js"),["assets/Home.50025206.js","assets/Home.1ee9be26.css","assets/vendor.626a96d0.js"]),props:!0},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>v(()=>import("./NotFound.fbfebf48.js"),["assets/NotFound.fbfebf48.js","assets/vendor.626a96d0.js"])}],B=ne({history:se(),routes:Te});B.beforeEach((e,o,t)=>{if(I&&e.name==="home"){I=!1,t({name:"favorites"});return}I=!1,t()});const ze=le(),Me="---",qe=u({}),Ke=u({}),Ye=u({}),x=u(!1),k=u({}),h={};let L,O;const Be=async(e,o)=>{if(k.value[e])return;if(!x.value||!O){h[e]=o;return}const t=ie();t.deliverTo(ce()),t.deliverAll(),t.ackNone(),t.replayInstantly();const a=await O.subscribe(e,t);k.value[e]=a,(async()=>{for await(const r of a){const s=ze.decode(r.data);if(s!==Me){const n=JSON.parse(s);o.value=Object.freeze(C(A({},o.value),{[n.id]:Object.freeze(n)}))}}})()},Qe=async e=>{k.value[e]&&(k.value[e].unsubscribe(),delete k.value[e]),h[e]&&delete h[e]},H=async()=>{await Promise.all(Object.keys(h).map(async e=>{await Be(e,h[e]),delete h[e]}))},He=async()=>{L=await ae({servers:"wss://api.kiel-live.ju60.de/",waitOnFirstConnect:!0}),x.value=!0,O=L.jetstream(),await H(),(async()=>{for await(const o of L.status())o.type===W.Disconnect&&(x.value=!1),o.type===W.Reconnect&&(x.value=!0,await H())})()},U=de(De);U.use(B);U.mount("#app");He();export{Pe as _,Ke as a,S as b,Qe as c,x as i,Be as s,Ye as t,Ne as u,qe as v};
//# sourceMappingURL=index.5177afce.js.map
