{"version":3,"sources":["webpack:///./src/views/Stop.vue?9d21","webpack:///./src/views/Stop.vue?fbf9","webpack:///src/views/Stop.vue","webpack:///./src/views/Stop.vue?ed58","webpack:///./src/views/Stop.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","$event","$router","go","_v","_s","stop","stopName","removeFavoriteStop","addFavoriteStop","push","name","params","stopId","alerts","length","_l","alert","key","title","_e","bus","passageid","openTrip","route","routeId","routeType","direction","eta","status","actual","staticRenderFns","beforeRouteUpdate","next","unload","load","computed","$route","arrivals","actualRelativeTime","Math","max","plannedTime","routes","forEach","watch","$store","commit","mounted","beforeDestroy","methods","i","id","minutes","dispatch","component"],"mappings":"wGAAA,W,kECAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAQF,EAAQ,KAAEI,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,IAAI,CAACE,YAAY,cAAcC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAIS,QAAQC,IAAI,MAAM,CAACN,EAAG,IAAI,CAACE,YAAY,+BAA+BF,EAAG,KAAK,CAACE,YAAY,SAAS,CAACN,EAAIW,GAAG,IAAIX,EAAIY,GAAGZ,EAAIa,KAAKC,UAAU,OAAQd,EAAc,WAAEI,EAAG,MAAM,CAACE,YAAY,uBAAuBC,GAAG,CAAC,MAAQP,EAAIe,qBAAqB,CAACX,EAAG,IAAI,CAACE,YAAY,kBAAkBF,EAAG,MAAM,CAACE,YAAY,kBAAkBC,GAAG,CAAC,MAAQP,EAAIgB,kBAAkB,CAACZ,EAAG,IAAI,CAACE,YAAY,kBAAkBF,EAAG,MAAM,CAACE,YAAY,aAAaC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAIS,QAAQQ,KAAK,CAAEC,KAAM,UAAWC,OAAQ,CAAEN,KAAMb,EAAIoB,aAAc,CAAChB,EAAG,IAAI,CAACE,YAAY,0BAA2BN,EAAIqB,QAAUrB,EAAIqB,OAAOC,OAAS,EAAGlB,EAAG,MAAM,CAACE,YAAY,UAAUN,EAAIuB,GAAIvB,EAAU,QAAE,SAASwB,GAAO,OAAOpB,EAAG,MAAM,CAACqB,IAAID,EAAME,MAAMpB,YAAY,SAAS,CAACF,EAAG,IAAI,CAACE,YAAY,qCAAqCF,EAAG,MAAM,CAACE,YAAY,WAAW,CAACN,EAAIW,GAAG,IAAIX,EAAIY,GAAGY,EAAME,OAAO,YAAW,GAAG1B,EAAI2B,KAAKvB,EAAG,MAAM,CAACE,YAAY,YAAY,CAACN,EAAIuB,GAAIvB,EAAY,UAAE,SAAS4B,GAAK,OAAOxB,EAAG,MAAM,CAACqB,IAAIG,EAAIC,UAAUvB,YAAY,MAAMC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAI8B,SAASF,MAAQ,CAACxB,EAAG,MAAM,CAACE,YAAY,QAAQ,CAAuC,QAArCN,EAAI+B,MAAMH,EAAII,SAASC,UAAqB7B,EAAG,IAAI,CAACE,YAAY,eAAeN,EAAI2B,KAA2C,UAArC3B,EAAI+B,MAAMH,EAAII,SAASC,UAAuB7B,EAAG,IAAI,CAACE,YAAY,eAAeN,EAAI2B,OAAOvB,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACN,EAAIW,GAAG,IAAIX,EAAIY,GAAGZ,EAAI+B,MAAMH,EAAII,SAASd,MAAM,OAAOd,EAAG,MAAM,CAACE,YAAY,aAAa,CAACN,EAAIW,GAAG,IAAIX,EAAIY,GAAGgB,EAAIM,WAAW,OAAO9B,EAAG,MAAM,CAACE,YAAY,OAAO,CAACN,EAAIW,GAAG,IAAIX,EAAIY,GAAGZ,EAAImC,IAAIP,IAAM,OAAOxB,EAAG,MAAM,CAACE,YAAY,UAAU,CAAiB,aAAfsB,EAAIQ,OAAuBhC,EAAG,IAAI,CAACE,YAAY,sBAAsBN,EAAI2B,KAAqB,YAAfC,EAAIQ,OAAsBhC,EAAG,IAAI,CAACE,YAAY,iBAAiBN,EAAI2B,KAAqB,cAAfC,EAAIQ,OAAwBhC,EAAG,IAAI,CAACE,YAAY,mBAAmBN,EAAI2B,YAAsC,GAA1B3B,EAAIa,KAAKwB,OAAOf,OAAalB,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,IAAI,CAACE,YAAY,eAAeF,EAAG,IAAI,CAACJ,EAAIW,GAAG,gDAAgDX,EAAI2B,MAAM,KAAKvB,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,IAAI,CAACE,YAAY,mCAC/sEgC,EAAkB,G,gFC4DtB,GACEpB,KAAM,OACNqB,kBAFF,SAEA,OACIC,IACAvC,KAAKwC,SACLxC,KAAKyC,QAEPC,SAAU,OAAZ,OAAY,CAAZ,iCACA,gBACI,KAAJ,YAAM,OAAN,gBAEA,gBACI,WAAJ,yBALA,IAOIvB,OAPJ,WAQM,OAAOnB,KAAK2C,OAAOzB,OAAON,MAE5BgC,SAVJ,WAWM,OAAK5C,KAAKY,KAGH,OAAb,aAAa,CAAb,8BACQ,MAAoB,aAAhBA,EAAKuB,OACA,EAGLvB,EAAKiC,mBAEAC,KAAKC,IAAInC,EAAKiC,mBAAoB,GAGpCjC,EAAKoC,eAZL,IAeX5B,OA3BJ,WA4BM,IAAKpB,KAAKY,KACR,MAAO,GAGT,IAAN,0BAMM,OAJAZ,KAAKY,KAAKqC,OAAOC,SAAQ,SAA/B,GACQ9B,EAAS,GAAjB,sDAGaA,KAGX+B,MAAO,CACLvC,KADJ,SACA,GACU,GACFZ,KAAKoD,OAAOC,OAAO,WAAY,EAAvC,YAIEC,QAvDF,WAwDItD,KAAKyC,QAEPc,cA1DF,WA2DIvD,KAAKwC,UAEPgB,QAAS,CACP1B,MADJ,SACA,GACM,IAAK,IAAX,mCACQ,GAAI9B,KAAKY,KAAKqC,OAAOQ,GAAGC,KAAO3B,EAC7B,OAAO/B,KAAKY,KAAKqC,OAAOQ,GAI5B,OAAO,MAETvB,IAVJ,SAUA,GACM,IAAN,sCAEM,MAAmB,aAAfP,EAAIQ,OACC,OAGU,YAAfR,EAAIQ,OACCR,EAAIqB,YAGTW,EAAU,EACL,SAGF,GAAb,kBAEI5C,gBA3BJ,WA4BUf,KAAKY,MAAQZ,KAAKY,KAAKC,UACzBb,KAAKoD,OAAOC,OAAO,uBAAwB,CAAnD,0CAGIvC,mBAhCJ,WAiCMd,KAAKoD,OAAOC,OAAO,0BAA2BrD,KAAKmB,SAErDU,SAnCJ,SAmCA,GACM7B,KAAKQ,QAAQQ,KAAK,CAAxB,0DAEIyB,KAtCJ,WAuCWzC,KAAKmB,OAKVnB,KAAKoD,OAAOQ,SAAS,YAAa5D,KAAKmB,QAJrCnB,KAAKQ,QAAQQ,KAAK,CAA1B,eAMIwB,OA9CJ,WA+CMxC,KAAKoD,OAAOQ,SAAS,kBCzKiV,I,wBCQxWC,EAAY,eACd,EACA/D,EACAuC,GACA,EACA,KACA,WACA,MAIa,aAAAwB,E","file":"js/stop.7399fcdd.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stop.vue?vue&type=style&index=0&id=43c1938c&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.stop)?_c('div',{staticClass:\"stop\"},[_c('div',{staticClass:\"header\"},[_c('a',{staticClass:\"back button\",on:{\"click\":function($event){return _vm.$router.go(-1)}}},[_c('i',{staticClass:\"fas fa-angle-double-left\"})]),_c('h1',{staticClass:\"title\"},[_vm._v(\" \"+_vm._s(_vm.stop.stopName)+\" \")]),(_vm.isFavorite)?_c('div',{staticClass:\"favorite gold button\",on:{\"click\":_vm.removeFavoriteStop}},[_c('i',{staticClass:\"fas fa-star\"})]):_c('div',{staticClass:\"favorite button\",on:{\"click\":_vm.addFavoriteStop}},[_c('i',{staticClass:\"far fa-star\"})]),_c('div',{staticClass:\"map button\",on:{\"click\":function($event){return _vm.$router.push({ name: 'mapStop', params: { stop: _vm.stopId }})}}},[_c('i',{staticClass:\"fas fa-map-marked\"})])]),(_vm.alerts && _vm.alerts.length > 0)?_c('div',{staticClass:\"alerts\"},_vm._l((_vm.alerts),function(alert){return _c('div',{key:alert.title,staticClass:\"alert\"},[_c('i',{staticClass:\"fas fa-exclamation-triangle icon\"}),_c('div',{staticClass:\"content\"},[_vm._v(\" \"+_vm._s(alert.title)+\" \")])])}),0):_vm._e(),_c('div',{staticClass:\"arrivals\"},[_vm._l((_vm.arrivals),function(bus){return _c('div',{key:bus.passageid,staticClass:\"bus\",on:{\"click\":function($event){return _vm.openTrip(bus)}}},[_c('div',{staticClass:\"icon\"},[(_vm.route(bus.routeId).routeType === 'bus')?_c('i',{staticClass:\"fas fa-bus\"}):_vm._e(),(_vm.route(bus.routeId).routeType === 'ferry')?_c('i',{staticClass:\"fas fa-bus\"}):_vm._e()]),_c('div',{staticClass:\"line\"},[_vm._v(\" \"+_vm._s(_vm.route(bus.routeId).name)+\" \")]),_c('div',{staticClass:\"direction\"},[_vm._v(\" \"+_vm._s(bus.direction)+\" \")]),_c('div',{staticClass:\"eta\"},[_vm._v(\" \"+_vm._s(_vm.eta(bus))+\" \")]),_c('div',{staticClass:\"status\"},[(bus.status === 'STOPPING')?_c('i',{staticClass:\"fas fa-hand-paper\"}):_vm._e(),(bus.status === 'PLANNED')?_c('i',{staticClass:\"fas fa-clock\"}):_vm._e(),(bus.status === 'PREDICTED')?_c('i',{staticClass:\"fas fa-running\"}):_vm._e()])])}),(_vm.stop.actual.length == 0)?_c('div',{staticClass:\"no-data\"},[_c('i',{staticClass:\"fas fa-ban\"}),_c('p',[_vm._v(\"Hier will gerade wohl kein Manni halten.\")])]):_vm._e()],2)]):_c('div',{staticClass:\"loading\"},[_c('i',{staticClass:\"fas fa-circle-notch fa-spin\"})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div v-if=\"stop\" class=\"stop\">\n    <div class=\"header\">\n      <a class=\"back button\" @click=\"$router.go(-1)\"><i class=\"fas fa-angle-double-left\" /></a>\n      <h1 class=\"title\">\n        {{ stop.stopName }}\n      </h1>\n      <div v-if=\"isFavorite\" class=\"favorite gold button\" @click=\"removeFavoriteStop\">\n        <i class=\"fas fa-star\" />\n      </div>\n      <div v-else class=\"favorite button\" @click=\"addFavoriteStop\">\n        <i class=\"far fa-star\" />\n      </div>\n      <div class=\"map button\" @click=\"$router.push({ name: 'mapStop', params: { stop: stopId }})\">\n        <i class=\"fas fa-map-marked\" />\n      </div>\n    </div>\n    <div v-if=\"alerts && alerts.length > 0\" class=\"alerts\">\n      <div v-for=\"alert in alerts\" :key=\"alert.title\" class=\"alert\">\n        <i class=\"fas fa-exclamation-triangle icon\" />\n        <div class=\"content\">\n          {{ alert.title }}\n        </div>\n      </div>\n    </div>\n    <div class=\"arrivals\">\n      <div v-for=\"bus in arrivals\" :key=\"bus.passageid\" class=\"bus\" @click=\"openTrip(bus)\">\n        <div class=\"icon\">\n          <i v-if=\"route(bus.routeId).routeType === 'bus'\" class=\"fas fa-bus\" />\n          <i v-if=\"route(bus.routeId).routeType === 'ferry'\" class=\"fas fa-bus\" />\n        </div>\n        <div class=\"line\">\n          {{ route(bus.routeId).name }}\n        </div>\n        <div class=\"direction\">\n          {{ bus.direction }}\n        </div>\n        <div class=\"eta\">\n          {{ eta(bus) }}\n        </div>\n        <div class=\"status\">\n          <i v-if=\"bus.status === 'STOPPING'\" class=\"fas fa-hand-paper\" />\n          <i v-if=\"bus.status === 'PLANNED'\" class=\"fas fa-clock\" />\n          <i v-if=\"bus.status === 'PREDICTED'\" class=\"fas fa-running\" />\n        </div>\n      </div>\n      <div v-if=\"stop.actual.length == 0\" class=\"no-data\">\n        <i class=\"fas fa-ban\" />\n        <p>Hier will gerade wohl kein Manni halten.</p>\n      </div>\n    </div>\n  </div>\n  <div v-else class=\"loading\">\n    <i class=\"fas fa-circle-notch fa-spin\" />\n  </div>\n</template>\n\n<script>\nimport { orderBy } from 'lodash';\nimport { mapState, mapGetters } from 'vuex';\n\nexport default {\n  name: 'Stop',\n  beforeRouteUpdate(to, from, next) {\n    next();\n    this.unload();\n    this.load();\n  },\n  computed: {\n    ...mapState({\n      stop: (state) => state.stop.stop,\n    }),\n    ...mapGetters({\n      isFavorite: 'stop/isFavoriteStop',\n    }),\n    stopId() {\n      return this.$route.params.stop;\n    },\n    arrivals() {\n      if (!this.stop) {\n        return [];\n      }\n      return orderBy(this.stop.actual, (stop) => {\n        if (stop.status === 'STOPPING') {\n          return 0;\n        }\n\n        if (stop.actualRelativeTime) {\n          // if eta is delayed set it to 1 to be greater than STOPPING arrivals\n          return Math.max(stop.actualRelativeTime, 1);\n        }\n\n        return stop.plannedTime;\n      });\n    },\n    alerts() {\n      if (!this.stop) {\n        return [];\n      }\n\n      let alerts = this.stop.generalAlerts;\n\n      this.stop.routes.forEach((route) => {\n        alerts = [...alerts, ...route.alerts];\n      });\n\n      return alerts;\n    },\n  },\n  watch: {\n    stop(stop) {\n      if (stop) {\n        this.$store.commit('setTitle', stop.stopName);\n      }\n    },\n  },\n  mounted() {\n    this.load();\n  },\n  beforeDestroy() {\n    this.unload();\n  },\n  methods: {\n    route(routeId) {\n      for (let i = 0; i < this.stop.routes.length; i += 1) {\n        if (this.stop.routes[i].id === routeId) {\n          return this.stop.routes[i];\n        }\n      }\n\n      return null;\n    },\n    eta(bus) {\n      const minutes = Math.round(bus.actualRelativeTime / 60);\n\n      if (bus.status === 'STOPPING') {\n        return 'hält';\n      }\n\n      if (bus.status === 'PLANNED') {\n        return bus.plannedTime;\n      }\n\n      if (minutes < 1) {\n        return 'sofort';\n      }\n\n      return `${minutes} Min`;\n    },\n    addFavoriteStop() {\n      if (this.stop && this.stop.stopName) {\n        this.$store.commit('stop/addFavoriteStop', { id: this.stopId, name: this.stop.stopName });\n      }\n    },\n    removeFavoriteStop() {\n      this.$store.commit('stop/removeFavoriteStop', this.stopId);\n    },\n    openTrip(bus) {\n      this.$router.push({ name: 'trip', params: { trip: bus.tripId, vehicle: bus.vehicleId } });\n    },\n    load() {\n      if (!this.stopId) {\n        this.$router.push({ name: 'home' });\n        return;\n      }\n\n      this.$store.dispatch('stop/load', this.stopId);\n    },\n    unload() {\n      this.$store.dispatch('stop/unload');\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n  .stop {\n    position: relative;\n    display: flex;\n    flex-flow: column;\n    width: 100%;\n    max-width: 40rem;\n    margin: 0 auto;\n    align-items: center;\n    padding-top: 1rem;\n\n    h1 {\n      margin: 0;\n    }\n\n    .header {\n      position: relative;\n      width: calc(100% - 1rem);\n      display: flex;\n      margin: 1rem .5rem;\n      margin-bottom: 2rem;\n      align-items: center;\n      justify-content: space-between;\n    }\n\n    .back {\n      margin-right: .5rem;\n    }\n\n    .title {\n      flex-grow: 2;\n    }\n\n    .favorite {\n      margin-left: 1rem;\n\n      &.gold {\n        color: gold;\n      }\n    }\n\n    .map {\n      margin-left: 1rem;\n    }\n  }\n\n  @media (min-width: 768px) {\n    .stop {\n      .header {\n        width: 100%;\n        margin-left: 0;\n        margin-right: 0;\n      }\n    }\n  }\n\n  .title {\n    margin: 1rem 0;\n    font-size: 1.8rem;\n  }\n\n  .arrivals {\n    display: flex;\n    flex-flow: column;\n    width: 100%;\n  }\n\n  .bus {\n    display: flex;\n    padding: 1rem;\n    flex-flow: row;\n    width: 100%;\n    box-shadow: inset 0 -1px 0 0 rgba(100,121,143,0.122);\n    text-align: left;\n    cursor: pointer;\n\n    &:hover {\n      -webkit-box-shadow: inset 1px 0 0 #dadce0, inset -1px 0 0 #dadce0, 0 1px 2px 0 rgba(60,64,67,.3), 0 1px 3px 1px rgba(60,64,67,.15);\n      box-shadow: inset 1px 0 0 #dadce0, inset -1px 0 0 #dadce0, 0 1px 2px 0 rgba(60,64,67,.3), 0 1px 3px 1px rgba(60,64,67,.15);\n      z-index: 1;\n    }\n\n    * {\n      display: flex;\n      align-items: center;\n    }\n\n    .icon {\n      margin-right: .5rem;\n    }\n\n    .line {\n      width: 1.5rem;\n    }\n\n    .direction {\n      margin-left: 1.5rem;\n      flex-grow: 1;\n    }\n\n    .eta {\n      width: 20%;\n      justify-content: flex-end;\n    }\n\n    .status {\n      width: 10%;\n      justify-content: flex-end;\n      font-size: 1.5rem;\n    }\n  }\n\n  .no-data {\n    margin: auto;\n\n    i {\n      font-size: 4rem;\n      margin-bottom: 1rem;\n    }\n  }\n\n  .loading {\n    margin: auto;\n    font-size: 4rem;\n  }\n\n  .alerts {\n    display: flex;\n    margin: 0 .5rem 1rem;\n    flex-flow: column;\n\n    .alert {\n      display: flex;\n      flex-flow: row;\n      color: #fff;\n      border-radius: 4px;\n      padding: 1.25rem 2.5rem 1.25rem 1.5rem;\n      position: relative;\n      width: 100%;\n      margin-bottom: .5rem;\n\n      background-color: #ff3860;\n      border-color: rgba(0,0,0,0.12) !important;\n\n      .icon {\n        margin-right: 1rem;\n      }\n    }\n  }\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stop.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stop.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Stop.vue?vue&type=template&id=43c1938c&scoped=true&\"\nimport script from \"./Stop.vue?vue&type=script&lang=js&\"\nexport * from \"./Stop.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Stop.vue?vue&type=style&index=0&id=43c1938c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"43c1938c\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}