{"version":3,"file":"useFeatureFlags-A7w9DXu8.js","sources":["../../src/compositions/useFeatureFlags.ts"],"sourcesContent":["import { useStorage } from '@vueuse/core';\nimport { computed, type Ref } from 'vue';\nimport { useI18n } from 'vue-i18n';\n\nimport { localStoragePrefix } from './useUserSettings';\n\nconst enabledFeatureFlags = useStorage<string[]>(`${localStoragePrefix}.feature_flags`, []);\n\ninterface FeatureFlag {\n  id: string;\n  name: string;\n  description?: string;\n}\n\nexport function useFeatureFlags() {\n  const { t } = useI18n();\n\n  const featureFlags = [\n    {\n      id: 'new_api',\n      name: t('feature_flag_new_api'),\n    },\n    {\n      id: 'vehicle_stop_actions',\n      name: t('feature_flag_actions'),\n      description: t('feature_flag_actions_description'),\n    },\n  ] satisfies FeatureFlag[];\n\n  const featureFlagWithEnabled = featureFlags.map((flag) => ({\n    ...flag,\n    enabled: computed({\n      get: () => enabledFeatureFlags.value.includes(flag.name),\n      set: (value) => {\n        if (value) {\n          enabledFeatureFlags.value = [...enabledFeatureFlags.value, flag.name];\n        } else {\n          enabledFeatureFlags.value = enabledFeatureFlags.value.filter((f) => f !== flag.name);\n        }\n      },\n    }),\n  }));\n\n  function checkFeatureFlag(flagId: string): Ref<boolean> {\n    const featureFlag = featureFlagWithEnabled.find((flag) => flag.id === flagId);\n\n    if (!featureFlag) {\n      throw new Error(`Unknown feature flag: ${flagId}`);\n    }\n\n    return featureFlag.enabled;\n  }\n\n  return {\n    featureFlags: featureFlagWithEnabled,\n    checkFeatureFlag,\n  };\n}\n"],"names":["enabledFeatureFlags","useStorage","localStoragePrefix","useFeatureFlags","t","useI18n","featureFlagWithEnabled","flag","computed","value","f","checkFeatureFlag","flagId","featureFlag"],"mappings":"wDAMA,MAAMA,EAAsBC,EAAqB,GAAGC,CAAkB,iBAAkB,CAAA,CAAE,EAQnF,SAASC,GAAkB,CAC1B,KAAA,CAAE,EAAAC,CAAE,EAAIC,EAAQ,EAchBC,EAZe,CACnB,CACE,GAAI,UACJ,KAAMF,EAAE,sBAAsB,CAChC,EACA,CACE,GAAI,uBACJ,KAAMA,EAAE,sBAAsB,EAC9B,YAAaA,EAAE,kCAAkC,CAAA,CAErD,EAE4C,IAAKG,IAAU,CACzD,GAAGA,EACH,QAASC,EAAS,CAChB,IAAK,IAAMR,EAAoB,MAAM,SAASO,EAAK,IAAI,EACvD,IAAME,GAAU,CACVA,EACFT,EAAoB,MAAQ,CAAC,GAAGA,EAAoB,MAAOO,EAAK,IAAI,EAEhDP,EAAA,MAAQA,EAAoB,MAAM,OAAQU,GAAMA,IAAMH,EAAK,IAAI,CACrF,CAEH,CAAA,CAAA,EACD,EAEF,SAASI,EAAiBC,EAA8B,CACtD,MAAMC,EAAcP,EAAuB,KAAMC,GAASA,EAAK,KAAOK,CAAM,EAE5E,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,yBAAyBD,CAAM,EAAE,EAGnD,OAAOC,EAAY,OAAA,CAGd,MAAA,CACL,aAAcP,EACd,iBAAAK,CACF,CACF"}