var q=Object.defineProperty,K=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var P=(e,o,t)=>o in e?q(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,A=(e,o)=>{for(var t in o||(o={}))Q.call(o,t)&&P(e,t,o[t]);if(N)for(var t of N(o))G.call(o,t)&&P(e,t,o[t]);return e},C=(e,o)=>K(e,Y(o));import{d as k,r as V,o as p,c as m,a as J,w,b as S,e as c,t as x,f as u,g as Z,h as X,i as ee,u as y,j as _,k as D,l as v,m as te,v as oe,n as re,p as ne,q as se,s as ae,E as W,x as ie,y as le,S as ce,z as de}from"./vendor.13b4a8f1.js";const ue=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}};ue();var j=(e,o)=>{const t=e.__vccOpts||e;for(const[a,r]of o)t[a]=r;return t};const fe=k({name:"Button",props:{to:{type:String,default:null},href:{type:String,default:null},text:{type:String,default:null}}}),pe={class:"border-1 hover:border-gray-300 dark:border-gray-400 dark:hover:border-gray-500 rounded p-2 flex justify-center cursor-pointer"},me=["href"],_e={key:2,type:"button"};function ve(e,o,t,a,r,s){const n=V("router-link");return p(),m("div",pe,[e.to?(p(),J(n,{key:0,class:"flex items-center",to:{name:e.to},replace:""},{default:w(()=>[S(e.$slots,"default",{},()=>[c("span",null,x(e.text),1)])]),_:3},8,["to"])):e.href?(p(),m("a",{key:1,href:e.href,target:"_blank",rel:"noopener noreferrer",class:"flex items-center"},[S(e.$slots,"default",{},()=>[c("span",null,x(e.text),1)])],8,me)):(p(),m("button",_e,[S(e.$slots,"default",{},()=>[c("span",null,x(e.text),1)])]))])}var $=j(fe,[["render",ve]]);const he={class:"m-2 flex flex-col rounded-md p-4 bg-white border-1 border-gray-200 shadow-xl z-20 md:w-104 dark:bg-dark-400 dark:text-gray-300 dark:border-dark-800"},ge={class:"flex flex-col text-center gap-4"},ye=c("span",{class:"text-xl mb-2"},"Wuhuu es gibt ein Update!",-1),be=c("span",null,"Die neue Version soll dir bei der Navigation durch Kiel noch besser helfen.",-1),ke=v("Schick uns gerne Feedback an "),we=["href"],xe=v(" und folge uns auf "),Ee=c("a",{href:"https://www.instagram.com/kiel.live/",target:"_blank",class:"underline"},"Instagram",-1),Se=v("."),$e={class:"flex flex-row w-full justify-center mt-8"},Re=v("Nice!"),T=k({setup(e){const o="kiel-live-version-v1",t="2.0.0",a=atob("YW5kcm9pZEBqdTYwLmRl"),r=u(localStorage.getItem(o)),s=Z(()=>r.value!==null&&r.value!==t);X(async()=>{const i=localStorage.getItem("version");i!==null&&(r.value=i,localStorage.removeItem("version"))}),ee(s,()=>{if(!s.value)return;const i=3*1e3,d=Date.now()+i,l=setInterval(()=>{if(d-Date.now()<=0){clearInterval(l);return}te({particleCount:100,spread:70,origin:{y:1.1},startVelocity:90,zIndex:2e3})},250)},{immediate:!0});function n(){localStorage.setItem(o,t),r.value=t}return(i,d)=>{const l=$;return y(s)?(p(),m("div",{key:0,class:"flex fixed top-0 left-0 right-0 bottom-0 bg-gray-900 bg-opacity-80 z-1000 justify-center items-center",onClick:n},[c("div",he,[c("div",ge,[ye,be,c("span",null,[ke,c("a",{href:`mailto:${y(a)}`,class:"underline"},x(y(a)),9,we),xe,Ee,Se])]),c("div",$e,[_(l,{type:"button",onClick:n},{default:w(()=>[Re]),_:1})])])])):D("",!0)}}});function Ie(e={}){const{immediate:o=!1,onNeedRefresh:t,onOfflineReady:a,onRegistered:r,onRegisterError:s}=e;let n,i;const d=async(l=!0)=>{l&&(n==null||n.addEventListener("controlling",O=>{O.isUpdate&&window.location.reload()})),i&&i.waiting&&await re(i.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){n=new oe("/sw.js",{scope:"/"}),n.addEventListener("activated",l=>{l.isUpdate||a==null||a()});{const l=()=>{t==null||t()};n.addEventListener("waiting",l),n.addEventListener("externalwaiting",l)}n.register({immediate:o}).then(l=>{i=l,r==null||r(l)}).catch(l=>{s==null||s(l)})}return d}function Le(e={}){const{immediate:o=!0,onNeedRefresh:t,onOfflineReady:a,onRegistered:r,onRegisterError:s}=e,n=u(!1),i=u(!1);return{updateServiceWorker:Ie({immediate:o,onNeedRefresh(){n.value=!0,t==null||t()},onOfflineReady(){i.value=!0,a==null||a()},onRegistered:r,onRegisterError:s}),offlineReady:i,needRefresh:n}}const Oe={key:0,class:"fixed left-0 right-0 bottom-0 mx-2 mb-2 flex flex-col rounded-md p-4 items-center justify-center bg-white border-1 border-gray-200 shadow-xl z-20 md:transform md:-translate-x-1/2 md:right-auto md:left-1/2 md:w-96 dark:bg-dark-400 dark:text-gray-300 dark:border-dark-800",role:"alert"},Ne=c("div",{class:"mb-2 text-xl"},[c("span",null,"Eine neue Version ist verf\xFCgbar.")],-1),Pe={class:"flex flex-row w-full gap-x-4 justify-center"},Ae=v("Installieren"),Ce=v("Abbrechen"),M=k({setup(e){const{needRefresh:o,updateServiceWorker:t}=Le(),a=async()=>{o.value=!1};return(r,s)=>y(o)?(p(),m("div",Oe,[Ne,c("div",Pe,[_($,{type:"button",onClick:s[0]||(s[0]=n=>y(t)(!0))},{default:w(()=>[Ae]),_:1}),_($,{type:"button",onClick:a},{default:w(()=>[Ce]),_:1})])])):D("",!0)}});function z(e){e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}const f=u(),Ve=()=>f.value!==void 0?f:window.matchMedia?(f.value=window.matchMedia("(prefers-color-scheme: dark)").matches,z(f.value),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{f.value=e.matches,z(f.value)}),f):(f.value=!1,f);const De=k({name:"App",components:{ReloadPrompt:M,UpdateNotice:T},setup(){return Ve(),{}}}),We={class:"app flex flex-col m-auto w-full h-full bg-gray-100 dark:bg-dark-400 dark:text-gray-300"};function je(e,o,t,a,r,s){const n=V("router-view"),i=M,d=T;return p(),m("div",We,[_(n),_(i),_(d)])}var Te=j(De,[["render",je],["__scopeId","data-v-2178efe9"]]);const Me="modulepreload",B={},ze="/",h=function(o,t){return!t||t.length===0?o():Promise.all(t.map(a=>{if(a=`${ze}${a}`,a in B)return;B[a]=!0;const r=a.endsWith(".css"),s=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${s}`))return;const n=document.createElement("link");if(n.rel=r?"stylesheet":Me,r||(n.as="script",n.crossOrigin=""),n.href=a,document.head.appendChild(n),r)return new Promise((i,d)=>{n.addEventListener("load",i),n.addEventListener("error",d)})})).then(()=>o())};let R=!0;const Be=[{path:"/",name:"home",component:()=>h(()=>import("./Home.0f6f689b.js"),["assets/Home.0f6f689b.js","assets/Home.1ee9be26.css","assets/vendor.13b4a8f1.js"])},{path:"/map/:markerType/:markerId",name:"map-marker",component:()=>h(()=>import("./Home.0f6f689b.js"),["assets/Home.0f6f689b.js","assets/Home.1ee9be26.css","assets/vendor.13b4a8f1.js"]),props:!0},{path:"/search",name:"search",component:()=>h(()=>import("./Home.0f6f689b.js"),["assets/Home.0f6f689b.js","assets/Home.1ee9be26.css","assets/vendor.13b4a8f1.js"]),props:!0},{path:"/favorites",name:"favorites",component:()=>h(()=>import("./Home.0f6f689b.js"),["assets/Home.0f6f689b.js","assets/Home.1ee9be26.css","assets/vendor.13b4a8f1.js"]),props:!0},{path:"/about",name:"about",component:()=>h(()=>import("./Home.0f6f689b.js"),["assets/Home.0f6f689b.js","assets/Home.1ee9be26.css","assets/vendor.13b4a8f1.js"]),props:!0},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>h(()=>import("./NotFound.3970cde6.js"),["assets/NotFound.3970cde6.js","assets/vendor.13b4a8f1.js"])}],H=ne({history:se(),routes:Be});H.beforeEach((e,o,t)=>{if(R&&e.name==="home"){R=!1,t({name:"favorites"});return}R=!1,t()});const He=ce(),Fe="---",Qe=u({}),Ge=u({}),Je=u({}),E=u(!1),b=u({}),g={};let I,L;const Ue=async(e,o)=>{if(b.value[e])return;if(!E.value||!L){g[e]=o;return}const t=ie();t.deliverTo(le()),t.deliverAll(),t.ackNone(),t.replayInstantly();const a=await L.subscribe(e,t);b.value[e]=a,(async()=>{for await(const r of a){const s=He.decode(r.data);if(s!==Fe){const n=JSON.parse(s);o.value=Object.freeze(C(A({},o.value),{[n.id]:Object.freeze(n)}))}}})()},Ze=async e=>{b.value[e]&&(b.value[e].unsubscribe(),delete b.value[e]),g[e]&&delete g[e]},F=async()=>{await Promise.all(Object.keys(g).map(async e=>{await Ue(e,g[e]),delete g[e]}))},qe=async()=>{I=await ae({servers:"wss://api.kiel-live.ju60.de/",waitOnFirstConnect:!0}),E.value=!0,L=I.jetstream(),await F(),(async()=>{for await(const o of I.status())o.type===W.Disconnect&&(E.value=!1),o.type===W.Reconnect&&(E.value=!0,await F())})()},U=de(Te);U.use(H);U.mount("#app");qe();export{j as _,Ge as a,$ as b,Ze as c,E as i,Ue as s,Je as t,Ve as u,Qe as v};
//# sourceMappingURL=index.ed965668.js.map
